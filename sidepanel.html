<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI 书签管理器</title>
  <link rel="stylesheet" href="sidepanel.css">
</head>
<body>
  <div class="sidepanel-container">
    <!-- 顶部工具栏 -->
    <header class="header">
      <div class="search-box">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"/>
          <path d="m21 21-4.35-4.35"/>
        </svg>
        <input type="text" id="searchInput" placeholder="搜索书签...">
      </div>
      <button id="settingsBtn" class="icon-btn" title="设置">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/>
          <circle cx="12" cy="12" r="3"/>
        </svg>
      </button>
    </header>

    <!-- 颜色快速筛选栏 -->
    <div class="color-bar">
      <div class="color-filter active" data-color="" title="全部">
        <div class="color-badge all">全</div>
      </div>
      <div class="color-filter" data-color="red" title="红色">
        <div class="color-badge" style="background-color: #ef4444;"></div>
      </div>
      <div class="color-filter" data-color="orange" title="橙色">
        <div class="color-badge" style="background-color: #f97316;"></div>
      </div>
      <div class="color-filter" data-color="yellow" title="黄色">
        <div class="color-badge" style="background-color: #eab308;"></div>
      </div>
      <div class="color-filter" data-color="green" title="绿色">
        <div class="color-badge" style="background-color: #22c55e;"></div>
      </div>
      <div class="color-filter" data-color="cyan" title="青色">
        <div class="color-badge" style="background-color: #06b6d4;"></div>
      </div>
      <div class="color-filter" data-color="blue" title="蓝色">
        <div class="color-badge" style="background-color: #3b82f6;"></div>
      </div>
      <div class="color-filter" data-color="purple" title="紫色">
        <div class="color-badge" style="background-color: #a855f7;"></div>
      </div>
    </div>

    <!-- 标签栏（可拖拽） -->
    <div class="tags-bar">
      <div class="tags-bar-header">
        <span>标签</span>
        <div class="tag-mode-buttons">
          <button id="tagSortModeBtn" class="tag-mode-btn" title="排序模式">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="4" y1="8" x2="20" y2="8"/>
              <line x1="4" y1="16" x2="20" y2="16"/>
              <circle cx="8" cy="8" r="2" fill="currentColor"/>
              <circle cx="16" cy="16" r="2" fill="currentColor"/>
            </svg>
          </button>
          <button id="tagEditModeBtn" class="tag-mode-btn" title="编辑模式">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
            </svg>
          </button>
          <button id="tagDeleteModeBtn" class="tag-mode-btn" title="删除模式">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="3 6 5 6 21 6"/>
              <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
            </svg>
          </button>
        </div>
      </div>
      <!-- 模式提示 -->
      <div id="tagModeHint" class="tag-mode-hint" style="display: none;">
        <span id="tagModeHintText"></span>
        <button id="exitTagModeBtn" class="exit-mode-btn">退出</button>
      </div>
      <div id="tagsList" class="tags-list">
        <!-- 标签将动态生成 -->
      </div>
      <button id="addTagBtn" class="add-tag-btn">+ 新建标签</button>
    </div>

    <!-- 书签列表 -->
    <div class="bookmarks-container">
      <div class="bookmarks-header">
        <span><span id="bookmarkCount">0</span> 个书签</span>
        <div class="sort-buttons">
          <button class="sort-btn" data-sort="custom" title="自定义排序（拖拽）">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="4" y1="8" x2="20" y2="8"/>
              <line x1="4" y1="16" x2="20" y2="16"/>
              <circle cx="8" cy="8" r="2" fill="currentColor"/>
              <circle cx="16" cy="16" r="2" fill="currentColor"/>
            </svg>
          </button>
          <button class="sort-btn" data-sort="name" title="按名称排序">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 6h16M4 12h10M4 18h6"/>
            </svg>
          </button>
          <button class="sort-btn" data-sort="time" title="按时间排序">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M12 6v6l4 2"/>
            </svg>
          </button>
          <button class="sort-btn" data-sort="domain" title="按域名排序">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
            </svg>
          </button>
          <button class="sort-btn" data-sort="color" title="按颜色排序">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"/>
            </svg>
          </button>
        </div>
      </div>
      <div id="bookmarksList" class="bookmarks-list">
        <!-- 书签将动态生成 -->
      </div>
      <div id="emptyState" class="empty-state hidden">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/>
        </svg>
        <p>没有找到书签</p>
        <small>使用 Ctrl+D 添加当前页面到书签</small>
      </div>
    </div>

    <!-- 颜色选择器浮层 -->
    <div id="colorPicker" class="color-picker-popup hidden">
      <div class="color-option" data-color="">
        <div class="color-dot no-color"></div>
        <span>无颜色</span>
      </div>
      <div class="color-option" data-color="red">
        <div class="color-dot" style="background-color: #ef4444;"></div>
        <span>红色</span>
      </div>
      <div class="color-option" data-color="orange">
        <div class="color-dot" style="background-color: #f97316;"></div>
        <span>橙色</span>
      </div>
      <div class="color-option" data-color="yellow">
        <div class="color-dot" style="background-color: #eab308;"></div>
        <span>黄色</span>
      </div>
      <div class="color-option" data-color="green">
        <div class="color-dot" style="background-color: #22c55e;"></div>
        <span>绿色</span>
      </div>
      <div class="color-option" data-color="cyan">
        <div class="color-dot" style="background-color: #06b6d4;"></div>
        <span>青色</span>
      </div>
      <div class="color-option" data-color="blue">
        <div class="color-dot" style="background-color: #3b82f6;"></div>
        <span>蓝色</span>
      </div>
      <div class="color-option" data-color="purple">
        <div class="color-dot" style="background-color: #a855f7;"></div>
        <span>紫色</span>
      </div>
    </div>

    <!-- AI 标签建议对话框 -->
    <div id="aiDialog" class="dialog-overlay hidden">
      <div class="dialog">
        <div class="dialog-header">
          <h3>AI 标签建议</h3>
          <button id="closeAIDialog" class="icon-btn">×</button>
        </div>
        <div class="dialog-content">
          <div id="aiLoading" class="ai-loading">
            <div class="spinner"></div>
            <span>AI 分析中...</span>
          </div>
          <div id="aiSuggestions" class="ai-suggestions hidden"></div>
        </div>
      </div>
    </div>

    <!-- 新建标签对话框 -->
    <div id="createTagDialog" class="dialog-overlay hidden">
      <div class="dialog dialog-create-tag">
        <div class="dialog-header">
          <h3>新建标签</h3>
          <button id="closeCreateTagDialog" class="icon-btn">×</button>
        </div>
        <div class="dialog-content">
          <div class="create-tag-tabs">
            <button class="create-tag-tab active" data-tab="single">单个创建</button>
            <button class="create-tag-tab" data-tab="batch">批量创建</button>
          </div>
          
          <!-- 单个创建 -->
          <div id="singleCreateTab" class="create-tag-panel">
            <div class="form-group">
              <label>标签名称</label>
              <input type="text" id="singleTagName" class="form-input" placeholder="输入标签名称" />
            </div>
            <div class="dialog-actions">
              <button id="cancelSingleCreate" class="btn-secondary">取消</button>
              <button id="confirmSingleCreate" class="btn-primary">创建</button>
            </div>
          </div>
          
          <!-- 批量创建 -->
          <div id="batchCreateTab" class="create-tag-panel hidden">
            <div class="form-group">
              <label>标签名称（每行一个）</label>
              <textarea id="batchTagNames" class="form-textarea" rows="8" placeholder="输入多个标签名称，每行一个&#10;例如：&#10;工作&#10;学习&#10;项目A"></textarea>
            </div>
            <div class="batch-preview">
              <span>将创建 <strong id="batchCount">0</strong> 个标签</span>
            </div>
            <div class="dialog-actions">
              <button id="cancelBatchCreate" class="btn-secondary">取消</button>
              <button id="confirmBatchCreate" class="btn-primary">批量创建</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 编辑标签对话框 -->
    <div id="editTagDialog" class="dialog-overlay hidden">
      <div class="dialog dialog-edit-tag">
        <div class="dialog-header">
          <h3>编辑标签</h3>
          <button id="closeEditTagDialog" class="icon-btn">×</button>
        </div>
        <div class="dialog-content">
          <div class="form-group">
            <label>标签名称</label>
            <input type="text" id="editTagName" class="form-input" placeholder="输入标签名称" />
          </div>
          <div class="dialog-actions">
            <button id="cancelEditTag" class="btn-secondary">取消</button>
            <button id="confirmEditTag" class="btn-primary">保存</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="storage.js"></script>
  <script src="ai.js"></script>
  <script src="sidepanel.js"></script>
</body>
</html>

