# 筛选互斥功能测试指南

## 测试准备

### 测试数据
准备以下书签用于测试：

| 书签 | 标签 | 颜色 |
|------|------|------|
| 书签 A | 工作 | 红色 |
| 书签 B | 工作, 重要 | 蓝色 |
| 书签 C | 学习 | 红色 |
| 书签 D | 学习, 个人 | 绿色 |
| 书签 E | 重要 | 无 |
| 书签 F | 无标签 | 黄色 |
| 书签 G | 无标签 | 无颜色 |

## 测试用例

### 测试 1：基础颜色筛选

#### 1.1 选择单个颜色
```
步骤：
1. 初始状态：显示所有书签
2. 点击"红色"颜色按钮

预期结果：
✅ 只显示书签 A 和 C（红色书签）
✅ 红色按钮高亮显示
✅ 其他颜色按钮不高亮
✅ 所有标签按钮不高亮
```

#### 1.2 切换颜色
```
步骤：
1. 当前状态：红色筛选激活
2. 点击"蓝色"颜色按钮

预期结果：
✅ 只显示书签 B（蓝色书签）
✅ 蓝色按钮高亮显示
✅ 红色按钮不再高亮
```

#### 1.3 取消颜色筛选
```
步骤：
1. 当前状态：蓝色筛选激活
2. 再次点击"蓝色"颜色按钮

预期结果：
✅ 显示所有书签（A-G）
✅ 所有颜色按钮都不高亮
```

### 测试 2：基础标签筛选

#### 2.1 选择单个标签
```
步骤：
1. 初始状态：显示所有书签
2. 点击"工作"标签

预期结果：
✅ 只显示书签 A 和 B（带"工作"标签）
✅ "工作"标签高亮显示
✅ 其他标签不高亮
✅ 所有颜色按钮不高亮
```

#### 2.2 添加第二个标签（多标签筛选）
```
步骤：
1. 当前状态："工作"标签筛选激活
2. 点击"重要"标签

预期结果：
✅ 显示书签 A, B, E（带"工作"**或**"重要"标签）
✅ "工作"和"重要"标签都高亮显示
✅ 所有颜色按钮仍不高亮
ℹ️ 注意：使用 OR 逻辑，不是 AND 逻辑
```

**OR vs AND 对比**：
```
书签数据：
- A: [工作]
- B: [工作, 重要]
- E: [重要]

OR 逻辑（当前实现）：显示 A, B, E
AND 逻辑（不是这样）：只显示 B（同时有两个标签）
```

#### 2.3 移除一个标签
```
步骤：
1. 当前状态："工作"+"重要"标签筛选激活
2. 再次点击"工作"标签

预期结果：
✅ 只显示书签 B 和 E（带"重要"标签）
✅ 只有"重要"标签高亮
✅ "工作"标签不再高亮
```

### 测试 3：互斥行为 - 颜色切换到标签

#### 3.1 从颜色切换到单个标签
```
步骤：
1. 点击"红色"颜色按钮（显示 A, C）
2. 点击"工作"标签

预期结果：
✅ 显示书签 A 和 B（带"工作"标签，包括所有颜色）
✅ "工作"标签高亮
✅ 红色按钮不再高亮 ← 重点验证
✅ 所有颜色按钮都不高亮
```

#### 3.2 从颜色切换到多个标签
```
步骤：
1. 点击"蓝色"颜色按钮（显示 B）
2. 点击"学习"标签
3. 点击"个人"标签

预期结果：
✅ 显示书签 C 和 D（带"学习"或"个人"标签）
✅ "学习"和"个人"标签都高亮
✅ 蓝色按钮不再高亮 ← 重点验证
```

### 测试 4：互斥行为 - 标签切换到颜色

#### 4.1 从单个标签切换到颜色
```
步骤：
1. 点击"工作"标签（显示 A, B）
2. 点击"绿色"颜色按钮

预期结果：
✅ 只显示书签 D（绿色书签，包括所有标签）
✅ 绿色按钮高亮
✅ "工作"标签不再高亮 ← 重点验证
✅ 所有标签按钮都不高亮
```

#### 4.2 从多个标签切换到颜色
```
步骤：
1. 点击"工作"标签（显示 A, B）
2. 点击"重要"标签（显示 A, B, E）
3. 点击"黄色"颜色按钮

预期结果：
✅ 只显示书签 F（黄色书签）
✅ 黄色按钮高亮
✅ "工作"和"重要"标签都不再高亮 ← 重点验证
✅ 所有标签按钮都不高亮
```

### 测试 5：与搜索结合

#### 5.1 搜索 + 颜色筛选
```
步骤：
1. 在搜索框输入"书签"
2. 点击"红色"颜色按钮

预期结果：
✅ 显示匹配"书签"关键字且为红色的书签（A, C）
✅ 红色按钮高亮
```

#### 5.2 搜索 + 标签筛选
```
步骤：
1. 在搜索框输入"书签"
2. 点击"工作"标签

预期结果：
✅ 显示匹配"书签"关键字且带"工作"标签的书签（A, B）
✅ "工作"标签高亮
```

#### 5.3 搜索 + 筛选切换
```
步骤：
1. 在搜索框输入"书签"
2. 点击"红色"颜色按钮（显示 A, C）
3. 点击"工作"标签

预期结果：
✅ 显示匹配"书签"关键字且带"工作"标签的书签（A, B）
✅ "工作"标签高亮
✅ 红色按钮不再高亮
✅ 搜索框内容保持"书签"
```

### 测试 6：边界情况

#### 6.1 "全部"颜色按钮
```
步骤：
1. 点击"工作"标签（显示 A, B）
2. 点击"全部"颜色按钮（data-color=""）

预期结果：
✅ 显示所有书签（A-G）
✅ "全部"按钮高亮
✅ "工作"标签不再高亮
```

#### 6.2 未标记书签标签
```
步骤：
1. 点击"红色"颜色按钮（显示 A, C）
2. 点击"未标记"特殊标签

预期结果：
✅ 显示无标签的书签（F, G）
✅ "未标记"标签高亮
✅ 红色按钮不再高亮
```

#### 6.3 空结果
```
步骤：
1. 点击"红色"颜色按钮
2. 在搜索框输入不存在的关键字

预期结果：
✅ 显示"未找到匹配的书签"空状态
✅ 红色按钮仍然高亮
✅ 搜索框显示输入的关键字
```

### 测试 7：快速切换

#### 7.1 连续切换颜色
```
步骤：
1. 点击"红色"按钮
2. 立即点击"蓝色"按钮
3. 立即点击"绿色"按钮

预期结果：
✅ 每次都正确显示对应颜色的书签
✅ 只有最后点击的颜色按钮高亮
✅ 无闪烁或错误状态
```

#### 7.2 连续切换标签
```
步骤：
1. 点击"工作"标签
2. 立即点击"学习"标签
3. 立即点击"重要"标签

预期结果：
✅ 正确显示所有选中标签的书签
✅ 所有选中的标签都高亮
✅ 颜色按钮始终不高亮
```

#### 7.3 颜色和标签快速切换
```
步骤：
1. 点击"红色"按钮
2. 立即点击"工作"标签
3. 立即点击"蓝色"按钮
4. 立即点击"学习"标签

预期结果：
✅ 最终显示"学习"标签的书签（C, D）
✅ 只有"学习"标签高亮
✅ 所有颜色按钮都不高亮
✅ 无 UI 错乱
```

### 测试 8：UI 状态验证

#### 8.1 标签芯片状态
```
检查点：
□ 标签栏中的标签芯片与筛选状态同步
□ 点击颜色后，所有标签芯片都失去高亮
□ 点击标签后，对应芯片高亮显示
```

#### 8.2 颜色按钮状态
```
检查点：
□ 颜色栏中的颜色按钮与筛选状态同步
□ 点击标签后，所有颜色按钮都失去高亮
□ 点击颜色后，对应按钮高亮显示
```

#### 8.3 书签卡片上的标签显示
```
检查点：
□ 书签卡片上的标签可以点击
□ 点击卡片上的标签后，正确激活标签筛选
□ 同时清除颜色筛选（如果有）
```

## 性能测试

### 大量书签测试
```
测试条件：
- 1000+ 书签
- 100+ 不同标签
- 所有颜色都有书签

测试步骤：
1. 点击颜色筛选
2. 切换到标签筛选
3. 测量响应时间

预期性能：
✅ 筛选响应时间 < 100ms
✅ UI 状态更新流畅
✅ 无卡顿或延迟
```

## 回归测试

确保新功能不影响其他功能：

- [ ] 书签添加/删除功能正常
- [ ] 书签编辑功能正常
- [ ] AI 标签建议功能正常
- [ ] 导入导出功能正常
- [ ] 去重功能正常
- [ ] 拖拽排序功能正常
- [ ] 主题切换功能正常

## 测试报告模板

```
测试日期: 2025-01-14
测试人员: [姓名]
浏览器版本: Chrome XXX
扩展版本: v2.0.2

测试结果：
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
测试 1: 基础颜色筛选
  1.1 选择单个颜色        [✅/❌]
  1.2 切换颜色            [✅/❌]
  1.3 取消颜色筛选        [✅/❌]

测试 2: 基础标签筛选
  2.1 选择单个标签        [✅/❌]
  2.2 添加第二个标签      [✅/❌]
  2.3 移除一个标签        [✅/❌]

测试 3: 互斥行为（颜色→标签）
  3.1 单个标签            [✅/❌]
  3.2 多个标签            [✅/❌]

测试 4: 互斥行为（标签→颜色）
  4.1 单个标签切换        [✅/❌]
  4.2 多个标签切换        [✅/❌]

测试 5: 与搜索结合
  5.1 搜索+颜色           [✅/❌]
  5.2 搜索+标签           [✅/❌]
  5.3 搜索+切换           [✅/❌]

测试 6: 边界情况
  6.1 全部按钮            [✅/❌]
  6.2 未标记标签          [✅/❌]
  6.3 空结果              [✅/❌]

测试 7: 快速切换
  7.1 连续切换颜色        [✅/❌]
  7.2 连续切换标签        [✅/❌]
  7.3 颜色标签快速切换    [✅/❌]

测试 8: UI 状态验证
  8.1 标签芯片状态        [✅/❌]
  8.2 颜色按钮状态        [✅/❌]
  8.3 卡片标签显示        [✅/❌]

性能测试
  大量书签测试            [✅/❌]
  响应时间：_____ms

回归测试                  [✅/❌]

问题记录：
1. [描述问题]
2. [描述问题]

总体评价：[通过/需修复/有保留意见]
```

## 已知限制

1. **不支持组合筛选**
   - 无法同时按颜色和标签筛选
   - 例如：不能筛选"红色且带工作标签"的书签

2. **筛选切换会清除状态**
   - 从颜色切换到标签时，无法"记住"之前的颜色选择
   - 需要重新选择

## 建议改进（未来）

1. **高级筛选模式**
   - 切换按钮：基础模式 ↔ 高级模式
   - 高级模式支持组合筛选

2. **筛选历史**
   - 记住最近使用的筛选组合
   - 快速切换到常用筛选

3. **保存筛选方案**
   - 保存常用的筛选设置
   - 一键应用预设方案

---

**测试版本**: v2.0.2  
**最后更新**: 2025-01-14
